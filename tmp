请编写PHP代码对数据文件（data）进行操作，尝试完成以下几个任务：

(1.删除不足12位的行
(2.删除重复行
(3.按CNAPS号校验算法删除错误数据行
(4.按substr(line,0,3)与substr(line,3,4)双条件正序对数据集进行排序
(5.保存数据集至用户根目录，文件名为其的SHA1值
(6.在代码最后一行调用memory_get_peak_usage(false)，并将返回值转换为kb输出


PS:
数据文件换行符为\n
PHP的内存已被限制为32M，不得调高内存限制
内存占用更低的代码可以获得更高的评分